{"version":3,"sources":["../src/logic.js","../src/app.js"],"names":[],"mappings":";;;;;;;;AAAA,IAAM,MAAM,GAAG,OAAO,CAAA,SAAA,CAAtB;;IAEM,K;;;AACL,mBAAe;AAAA;;AACd,SAAK,QAAL;AACA;;;;+BAEW;AACX,WAAK,MAAL,GAAc,EAAd;AACA,WAAK,QAAL,GAAgB,EAAhB;AACA,WAAK,KAAL,GAAa,EAAb;AACA;;;gCAEY;AACZ,WAAK,QAAL;AACA;;;gCAEY;AACZ,UAAI,WAAW,GAAG,EAAlB;;AACA,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA6C;AAC5C,QAAA,WAAW,CAAC,IAAZ,CACC;AACC,UAAA,CAAC,EAAE,KAAK,MAAL,CAAY,CAAZ,EAAe,QAAf,CAAwB,CAD5B;AAEC,UAAA,CAAC,EAAE,KAAK,MAAL,CAAY,CAAZ,EAAe,QAAf,CAAwB,CAF5B;AAGC,UAAA,QAAQ,EAAE,KAAK,QAAL,CAAc,CAAd;AAHX,SADD;AAOA;;AACD,aAAO,KAAK,MAAZ;AACA;;;6BAES,C,EAAG,C,EAAG;AAAA;;AACf,UAAM,CAAC,GAAG,IAAI,MAAM,CAAC,OAAX,CAAmB,CAAnB,EAAsB,CAAtB,CAAV;AACA,UAAI,WAAW,GAAG,KAAlB;;AAEA,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,MAAL,CAAY,MAAhC,EAAwC,CAAC,EAAzC,EAA6C;AAC5C,YAAI,CAAC,CAAC,MAAF,CAAS,KAAK,MAAL,CAAY,CAAZ,CAAT,CAAJ,EAA8B;AAC7B,UAAA,WAAW,GAAG,IAAd;AACA,eAAK,QAAL,CAAc,CAAd;AACA;AACD;;AAED,UAAG,CAAE,WAAL,EAAkB;AACd;AACH,aAAK,QAAL,CAAc,IAAd,CAAmB,CAAnB;AACA,YAAM,MAAM,GAAG,KAAK,MAAL,CAAY,IAAZ,CAAiB,CAAjB,IAAsB,CAArC,CAHiB,CAId;AAEA;AACA;AACA;AAEA;AACA;AACA;AACH;AACG;AACA;AACA;AACA;AACA;AACA;AACA;;AACH,QAAA,MAAM,CAAC,IAAP,CACC,KAAK,KAAL,CAAW,MAAX,CAAkB,UAAA,IAAI;AAAA,iBAAI,KAAI,CAAC,KAAL,CAAW,CAAX,EAAc,QAAd,CAAuB,MAAvB,CAAJ;AAAA,SAAtB,EACC,MADD,EACS;AACR,kBAAC,GAAD,EAAM,IAAN,EAAe;AACd,UAAA,GAAG,CAAC,IAAJ,CAAS,GAAT,CAAa,UAAA,KAAK,EAAI;AACrB,YAAA,GAAG,CAAC,KAAD,CAAH,GAAa,IAAb;AACD,WAFA;AAGA,iBAAO,GAAP;AACD,SAPD,EAQC,EARD,CADD,EAWE,GAXF,CAWM,UAAA,KAAK,EAAI;AACd;AACA;AACA,UAAA,KAAI,CAAC,KAAL,CAAW,IAAX,CACC,IAAI,IAAJ,CAAS,KAAT,EAAe,MAAf,EAAuB,KAAvB,CADD;AAGD,SAjBA;AAkBA;AACD;;;;;;IAGI,I;;;AACL,gBAAa,KAAb,EAAoB,CAApB,EAAuB,CAAvB,EAA0B;AAAA;;AACzB,SAAK,KAAL,GAAa,KAAb;AAEA,SAAK,MAAL,GAAc,KAAK,KAAL,CAAW,QAAX,CAAoB,CAApB,CAAd;AACA,SAAK,MAAL,GAAc,KAAK,KAAL,CAAW,QAAX,CAAoB,CAApB,CAAd;AAEA,SAAK,SAAL,GAAiB,MAAM,CAAC,OAAP,CAChB,KAAK,MADW,EAEhB,KAAK,MAFW,EAGf,SAHe,EAAjB;AAKA,SAAK,IAAL,GAAY,CAAC,CAAD,EAAI,CAAJ,CAAZ;AACA,G,CAEA;AACA;;;;;6BACS,C,EAAG;AACZ,UAAI,GAAG,GAAG,KAAK,gBAAL,CAAsB,CAAtB,CAAV;;AACA,UAAI,GAAJ,EAAS;AACR,aAAK,IAAL,CAAU,IAAV,CAAe,CAAf;AACA;;AAED,aAAO,GAAP;AACA;;;oCAEgB,C,EAAG;AACnB,UAAI,KAAK,GAAG,KAAK,KAAL,CAAW,QAAX,CAAoB,CAApB,CAAZ;AAEA,UAAM,oBAAoB,GAAG,MAAM,CAAC,OAAP,CAC5B,KAD4B,EAE5B,KAAK,MAFuB,EAG3B,SAH2B,EAA7B;AAKA,UAAM,4BAA4B,GAAG,oBAAoB,CAAC,MAArB,EAArC;AAEA,aAAO,KAAK,SAAL,CAAe,GAAf,CAAmB,oBAAnB,MAA6C,CAA7C,IAAkD,KAAK,SAAL,CAAe,GAAf,CAAmB,4BAAnB,MAAqD,CAA9G;AACA;;;;KAGF;AC7HA;;;AAEA,IAAI,OAAO,GAAG,OAAO,CAAA,SAAA,CAArB;;AACA,IAAI,GAAG,GAAG,OAAO,EAAjB;;AACA,IAAI,OAAO,GAAG,OAAO,CAAA,aAAA,CAArB;;AACA,IAAI,IAAI,GAAG,OAAO,CAAA,MAAA,CAAlB;;AAEA,IAAI,aAAa,GAAG,CACnB;AAAC,EAAA,CAAC,EAAE,CAAJ;AAAO,EAAA,CAAC,EAAE;AAAV,CADmB,EAEnB;AAAC,EAAA,CAAC,EAAE,EAAJ;AAAQ,EAAA,CAAC,EAAE;AAAX,CAFmB,EAGnB;AAAC,EAAA,CAAC,EAAE,CAAJ;AAAO,EAAA,CAAC,EAAE;AAAV,CAHmB,EAInB;AAAC,EAAA,CAAC,EAAE,EAAJ;AAAQ,EAAA,CAAC,EAAE;AAAX,CAJmB,CAApB;AAQA,IAAM,MAAM,GAAG,CACd,WADc,EAEd,mBAFc,CAAf;AAKA,GAAG,CAAC,GAAJ,CAAQ,OAAO,CAAC,UAAR,CAAkB;AAAG,EAAA,QAAQ,EAAE;AAAb,CAAlB,CAAR;AACA,GAAG,CAAC,GAAJ,CAAQ,OAAO,CAAC,IAAR,CAAY,EAAZ,CAAR,E,CAEA;;AACA,IAAI,KAAK,GAAG,EAAZ;AACA,KAAK,CAAA,GAAA,CAAL,GAAa,kBAAkB,CAAA,GAAA,CAA/B;AACA,KAAK,CAAA,GAAA,CAAL,GAAa,kBAAkB,CAAA,GAAA,CAA/B;AACA,KAAK,CAAA,GAAA,CAAL,GAAa,kBAAkB,CAAA,GAAA,CAA/B;AACA,KAAK,CAAA,GAAA,CAAL,GAAa,kBAAkB,CAAA,GAAA,CAA/B;AACA,KAAK,CAAA,GAAA,CAAL,GAAa,kBAAkB,CAAA,GAAA,CAA/B,C,CAEA;;AACA,IAAI,GAAG,GAAG,EAAV;AACA,GAAG,CAAC,GAAJ,GAAU,MAAM,KAAK,CAAA,GAAA,CAAX,GAAmB,IAA7B;AACA,GAAG,CAAC,GAAJ,GAAU,MAAM,KAAK,CAAA,GAAA,CAAX,GAAmB,IAA7B,C,CAEA;;AACA,IAAI,KAAK,GAAG,IAAI,KAAJ,EAAZ,C,CACA;;AACA,aAAa,CAAC,GAAd,CACC,UAAA,IAAI,EAAI;AACP,EAAA,KAAK,CAAC,QAAN,CAAe,IAAI,CAAC,CAApB,EAAuB,IAAI,CAAC,CAA5B;AACA,CAHF,E,CAMA;;AACA,IAAI,MAAM,GAAG,OAAO,CAAC,MAAR,EAAb,C,CAEA;;AACA,MAAM,CAAC,GAAP,CAAW,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACpC,EAAA,IAAI;AACL,CAFA;AAIA,MAAM,CAAC,GAAP,CAAU,GAAV,EAAgB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACnC,EAAA,GAAG,CAAC,IAAJ,CAAQ;AACP,YAAQ;AADD,GAAR;AAGD,CAJA,E,CAMA;;AACA,MAAM,CAAC,KAAP,iBAAsB,KAAK,CAAA,GAAA,CAA3B,iBAAuC,KAAK,CAAA,GAAA,CAA5C,iBAAwD,KAAK,CAAA,GAAA,CAA7D,SAAqE,KAAK,CAAA,GAAA,CAA1E,SAAkF,KAAK,CAAA,GAAA,CAAvF,SAA+F,KAAK,CAAA,GAAA,CAApG,cAA6G,KAAK,CAAA,GAAA,CAAlH,gBAA6H,KAAK,CAAA,GAAA,CAAlI,gBAA6I,KAAK,CAAA,GAAA,CAAlJ,SAA0J,KAAK,CAAA,GAAA,CAA/J,cAAwK,KAAK,CAAA,GAAA,CAA7K,gBAAwL,KAAK,CAAA,GAAA,CAA7L,eAAuM,KAAK,CAAA,GAAA,CAA5M,SAAoN,KAAK,CAAA,GAAA,CAAzN,GACC,IADD,CACM,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AAC/B,MAAM,OAAO,GAAG,MAAM,CAAC,QAAP,CAAgB,GAAG,CAAC,MAAJ,CAAW,CAA3B,CAAhB;AACA,MAAM,OAAO,GAAG,MAAM,CAAC,QAAP,CAAgB,GAAG,CAAC,MAAJ,CAAW,CAA3B,CAAhB;;AAEA,MAAI,MAAM,CAAC,KAAP,CAAa,OAAb,KAAyB,MAAM,CAAC,KAAP,CAAa,OAAb,CAA7B,EAAoD;AACnD,IAAA,IAAI,CAAC,IAAI,KAAJ,CAAU,CAAV,CAAD,CAAJ;AACA,GAN8B,CAO9B;;;AACD,EAAA,KAAK,CAAC,QAAN,CAAe,OAAf,EAAwB,OAAxB;AAEA,EAAA,GAAG,CAAC,IAAJ,CAAQ;AACP,WAAO,sBADA;AAEP,SAAK,OAFE;AAGP,SAAK;AAHE,GAAR;AAKD,CAhBA,E,CAkBA;;AACA,MAAM,CAAC,KAAP,CAAY,QAAZ,EACC,GADD,CACK,UAAU,GAAV,EAAe,GAAf,EAAoB;AACxB,EAAA,GAAG,CAAC,IAAJ,CAAQ;AACP,cAAU,KAAK,CAAC,SAAN;AADH,GAAR;AAGD,CALA,EAMC,MAND,CAMQ,UAAU,GAAV,EAAe,GAAf,EAAoB;AAC1B;AACD,EAAA,KAAK,CAAC,SAAN;AACA,EAAA,GAAG,CAAC,IAAJ,CAAQ;AACP,WAAO;AADA,GAAR;AAGD,CAZA,E,CAcA;;AACA,MAAM,CAAC,KAAP,kBAAuB,KAAK,CAAA,GAAA,CAA5B,iBAAwC,KAAK,CAAA,GAAA,CAA7C,GACC,GADD,CACK,UAAU,GAAV,EAAe,GAAf,EAAoB;AACxB,EAAA,GAAG,CAAC,IAAJ,CAAQ;AACP,YAAQ;AADD,GAAR;AAGD,CALA;AAOA,MAAM,CAAC,GAAP,CAAW,YAAX,E,CAEA;AACA;AACA;;AACA,SAAS,YAAT,CAAuB,GAAvB,EAA4B,GAA5B,EAAiC,GAAjC,EAAsC,IAAtC,EAA4C;AAC3C,EAAA,GAAG,CAAC,MAAJ,CAAW,GAAX;AACA,EAAA,GAAG,CAAC,IAAJ,CACC;AACC,aAAS;AADV,GADD;AAKA,EAAA,OAAO,CAAC,KAAR,CAAc,GAAd;AACA,EAAA,IAAI;AACJ,C,CAED;;;AACA,GAAG,CAAC,GAAJ,CAAO,MAAP,EAAgB,MAAhB,E,CAEA;;AACA,GAAG,CAAC,MAAJ,CAAW,IAAX","sourcesContent":["const MathDS = require('math-ds');\n\nclass Plane {\n\tconstructor () {\n\t\tthis.initData();\n\t}\n\n\tinitData () {\n\t\tthis.points = [];\n\t\tthis.quantity = [];\n\t\tthis.lines = [];\n\t}\n\n\tdeleteAll () {\n\t\tthis.initData();\n\t}\n\n\tgetPoints () {\n\t\tvar pointsArray = [];\n\t\tfor (var i = 0; i < this.points.length; i++) {\n\t\t\tpointsArray.push(\n\t\t\t\t{\n\t\t\t\t\tx: this.points[i].position.x,\n\t\t\t\t\ty: this.points[i].position.y,\n\t\t\t\t\tquantity: this.quantity[i]\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn this.points;\n\t}\n\n\taddPoint (x, y) {\n\t\tconst p = new MathDS.Vector2(x, y);\n\t\tvar isDuplicate = false;\n\n\t\tfor (var i = 0; i < this.points.length; i++) {\n\t\t\tif (p.equals(this.points[i])) {\n\t\t\t\tisDuplicate = true;\n\t\t\t\tthis.quantity[i] ++;\n\t\t\t}\n\t\t}\n\n\t\tif (!isDuplicate) {\n      // add the point\n\t\t\tthis.quantity.push(1);\n\t\t\tconst pIndex = this.points.push(p) - 1;\n      // add lines\n\n      // the point is a new one, so I need to add it\n      // if the point is on the same axis the line is, addPoint() method\n      // will return true, false otherwise\n\n      // well now let's explain this line of code:\n      // Every time I add new point to the plain there are two thing that may\n      // happen\n\t\t\t// - the firts is the new point belong to the line\n      // - the second is that it doens't\n      // so in firts case the point is \"connected\" to all line's point through\n      // the line, this mean I do not need to add new line segment to the plain,\n      // because there already is one.\n      // In the second case the points of the line may be or may be not connected\n      // to the point through some line. So I need to filter all points that are\n      // connected to the current point and keep those that are not connected\n\t\t\tObject.keys(\n\t\t\t\tthis.lines.filter(item => this.lines[i].addPoint(pIndex))\n\t\t\t\t.reduce( // will return an object with unic keys\n\t\t\t\t\t(acc, item) => {\n\t\t\t\t\t\tacc.pool.map(point => {\n\t\t\t\t\t\t\tacc[point] = true;\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t},\n\t\t\t\t\t{}\n\t\t\t\t)\n\t\t\t).map(point => {\n\t\t\t\t// I use the code above to get all points that are not connected with line\n\t\t\t\t// segment to the new point, though the new line segments must be created\n\t\t\t\tthis.lines.push(\n\t\t\t\t\tnew Line(this, pIndex, point)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass Line {\n\tconstructor (plane, a, b) {\n\t\tthis.plane = plane;\n\n\t\tthis.center = this.plane.getPoint(a);\n\t\tthis.vertex = this.plane.getPoint(b);\n\n\t\tthis.distanceV = MathDS.Vector2(\n\t\t\tthis.vertex,\n\t\t\tthis.center\n\t\t).normalize();\n\n\t\tthis.pool = [a, b];\n\t}\n\n  // p is an index inside plane.points array, and addPoint return true\n  // only if the point belog to the line\n\taddPoint (p) {\n\t\tvar res = this.isOnTheSameAxies(p);\n\t\tif (res) {\n\t\t\tthis.pool.push(p);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tisOnTheSameAxis (p) {\n\t\tvar point = this.plane.getPoint(p);\n\n\t\tconst differenceFromCenter = MathDS.Vector2(\n\t\t\tpoint,\n\t\t\tthis.center\n\t\t).normalize();\n\n\t\tconst negativeDifferenceFromCenter = differenceFromCenter.negate();\n\n\t\treturn this.distanceV.dot(differenceFromCenter) === 1 || this.distanceV.dot(negativeDifferenceFromCenter) === 1;\n\t}\n}\n\n// export default Plane;\n","// import Plane from './logic';\n\nvar express = require('express');\nvar app = express();\nvar bParser = require('body-parser');\nvar path = require('path');\n\nvar pointsForTest = [\n\t{x: 3, y: 5},\n\t{x: 15, y: 178},\n\t{x: 3, y: 5},\n\t{x: 43, y: 0}\n];\n\n\nconst errors = [\n\t'no errors',\n\t'wrong coordinates'\n];\n\napp.use(bParser.urlencoded({ extended: true }));\napp.use(bParser.json([]));\n\n// special character managment\nvar chars = {};\nchars['{'] = encodeURIComponent('{');\nchars['}'] = encodeURIComponent('}');\nchars[','] = encodeURIComponent(',');\nchars['\"'] = encodeURIComponent('\"');\nchars[' '] = encodeURIComponent(' ');\n\n// pattern mana\nvar pat = {};\npat.wSp = '(' + chars[' '] + ')+';\npat.wSs = '(' + chars[' '] + ')*';\n\n// logic\nvar plane = new Plane();\n// init palne\npointsForTest.map(\n\titem => {\n\t\tplane.addPoint(item.x, item.y);\n\t}\n);\n\n// init router\nvar router = express.Router();\n\n// jsut for debug\nrouter.use(function (req, res, next) {\n\tnext();\n});\n\nrouter.get('/', function (req, res) {\n\tres.json({\n\t\t'api/': ''\n\t});\n});\n\n// add a point with body\nrouter.route(`/point${chars[' ']}with${chars[' ']}body${chars[' ']}${chars['{']}${chars[' ']}${chars['\"']}x${chars['\"']}\\\\:${chars[' ']}:x,${chars[' ']}${chars['\"']}y${chars['\"']}\\\\:${chars[' ']}:y${chars[' ']}${chars['}']}`)\n.post(function (req, res, next) {\n\tconst xNumber = Number.parseInt(req.params.x);\n\tconst yNumber = Number.parseInt(req.params.y);\n\n\tif (Number.isNaN(xNumber) || Number.isNaN(yNumber)) {\n\t\tnext(new Error(1));\n\t}\n  // so far everything is ok\n\tplane.addPoint(xNumber, yNumber);\n\n\tres.json({\n\t\t'msg': 'Point has been added',\n\t\t'x': xNumber,\n\t\t'y': yNumber\n\t});\n});\n\n// view & delete all points\nrouter.route('/space')\n.get(function (req, res) {\n\tres.json({\n\t\t'points': plane.getPoints()\n\t});\n})\n.delete(function (req, res) {\n  // delete points from plane\n\tplane.deleteAll();\n\tres.json({\n\t\t'msg': 'the space is empty now'\n\t});\n});\n\n// line numbers\nrouter.route(`/lines/${chars['{']}:num${chars['}']}`)\n.get(function (req, res) {\n\tres.json({\n\t\t'line': {}\n\t});\n});\n\nrouter.use(errorHandler);\n\n// router.all('/*', function (req, res) {\n// \tconsole.log('specific handler');\n// });I\nfunction errorHandler (err, req, res, next) {\n\tres.status(500);\n\tres.json(\n\t\t{\n\t\t\t'error': err\n\t\t}\n\t);\n\tconsole.error(err);\n\tnext();\n}\n\n// add routes for space\napp.use('/api', router);\n\n// port listening\napp.listen(3000);\n"],"file":"node_exercise.dev.js"}