/*! node_exercise 17-12-2018 */

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var MathDS=require("math-ds"),Plane=function(){function e(){_classCallCheck(this,e),this.initData()}return _createClass(e,[{key:"initData",value:function(){this.points=[],this.quantity=[],this.lines=[]}},{key:"deleteAll",value:function(){this.initData()}},{key:"getPoints",value:function(){for(var e=[],t=0;t<this.points.length;t++)e.push({x:this.points[t].x,y:this.points[t].y,quantity:this.quantity[t]});return e}},{key:"getLinesWithPoints",value:function(t){var n=this;this.lines.filter(function(e){return t===e.reduce(function(e,t){n.quantity[t]},0)})}},{key:"test",value:function(){console.log("points",this.points),console.log("lines",this.lines)}},{key:"addPoint",value:function(e,t){for(var n=this,s=new MathDS.Vector2(e,t),r=!1,o=0;o<this.points.length;o++)s.equals(this.points[o])&&(r=!0,this.quantity[o]++);if(!r){this.quantity.push(1);var i=this.points.push(s)-1;console.log(this.lines.filter(function(e){return n.lines[o].addPoint(i)})),console.log(this.lines.filter(function(e){return n.lines[o].addPoint(i)}).reduce(function(t,e){return t.pool.map(function(e){t[e]=!0}),t},{})),Object.keys(this.lines.filter(function(e){return n.lines[o].addPoint(i)}).reduce(function(t,e){return t.pool.map(function(e){t[e]=!0}),t},{})).map(function(e){n.lines.push(new Line(n,i,e))})}}}]),e}(),Line=function(){function s(e,t,n){_classCallCheck(this,s),this.plane=e,this.center=this.plane.getPoint(t),this.vertex=this.plane.getPoint(n),this.distanceV=MathDS.Vector2(this.vertex,this.center).normalize(),this.pool=[t,n]}return _createClass(s,[{key:"addPoint",value:function(e){var t=this.isOnTheSameAxies(e);return t&&this.pool.push(e),t}},{key:"isOnTheSameAxis",value:function(e){var t=this.plane.getPoint(e),n=MathDS.Vector2(t,this.center).normalize(),s=n.negate();return 1===this.distanceV.dot(n)||1===this.distanceV.dot(s)}}]),s}(),express=require("express"),app=express(),bParser=require("body-parser"),pointsForTest=[{x:3,y:5},{x:15,y:178},{x:3,y:5},{x:43,y:0}];app.use(bParser.urlencoded({extended:!0})),app.use(bParser.json([]));var chars={};chars["{"]=encodeURIComponent("{"),chars["}"]=encodeURIComponent("}"),chars[","]=encodeURIComponent(","),chars['"']=encodeURIComponent('"'),chars[" "]=encodeURIComponent(" ");var pat={};pat.wSp="("+chars[" "]+")+",pat.wSs="("+chars[" "]+")*";var plane=new Plane;pointsForTest.map(function(e){plane.addPoint(e.x,e.y)});var router=express.Router();function errorHandler(e,t,n,s){n.status(500),n.json({error:e}),console.error(e),s()}router.use(function(e,t,n){n()}),router.get("/",function(e,t){t.json({"api/":""})}),router.route("/point".concat(chars[" "],"with").concat(chars[" "],"body").concat(chars[" "]).concat(chars["{"]).concat(chars[" "]).concat(chars['"'],"x").concat(chars['"'],"\\:").concat(chars[" "],":x,").concat(chars[" "]).concat(chars['"'],"y").concat(chars['"'],"\\:").concat(chars[" "],":y").concat(chars[" "]).concat(chars["}"])).post(function(e,t,n){var s=Number.parseInt(e.params.x),r=Number.parseInt(e.params.y);(Number.isNaN(s)||Number.isNaN(r))&&n(new Error(1)),plane.addPoint(s,r),t.json({msg:"Point has been added",x:s,y:r})}),router.route("/space").get(function(e,t){t.json({points:plane.getPoints()})}).delete(function(e,t){plane.deleteAll(),t.json({msg:"the space is empty now"})}),router.route("/lines/".concat(chars["{"],":num").concat(chars["}"])).get(function(e,t){t.json({line:{}})}),router.route("/test").get(function(e,t){plane.test(),t.json({test:"look at terminal"})}),router.use(errorHandler),app.use("/api",router),app.listen(3e3);
//# sourceMappingURL=node_exercise.min.js.map